# 网络编程（福利课，正式课程）

## 一、网络模型

1. OSI 七层网络模型  概念

| 具体7层    | 数据格式 | 功能连接方式 | 典型设备       |
| ---------- | -------- | ------------ | -------------- |
| 应用层     |          |              |                |
| 表示层     |          |              |                |
| 会话层     |          |              |                |
| 传输层     |          |              | pc，手机       |
| 网络层     |          |              | 路由器         |
| 数据链路层 |          |              | 交换机         |
| 物理层     |          |              | 光纤，同轴电缆 |

2. TCP/IP网络模型  实际应用的

| OSI        | 功能 | TCP/IP                      |
| ---------- | ---- | --------------------------- |
| 应用层     |      | 应用层 HTTP，FTP，DNS，SMTP |
| 表示层     |      |                             |
| 会话层     |      |                             |
| 传输层     |      | 传输层 TCP，UDP             |
| 网络层     |      | 网络层 IP                   |
| 数据链路层 |      |                             |
| 物理层     |      | 物理层                      |

3. TCP协议（重要，面试，研发的）非常复杂，

TCP是一种面向连接的，可靠的，基于字节流的传输通信协议。

TCP需要先建立连接，然后传输，在传输的时候，还会做校验，如果有错误，重新传。

总结：3次握手，4次挥手

互联网传输数据主要用到两个协议，TCP，UDP

UDP是一种无连接的，不可靠的，基于字节流的传输层通信协议。

类比：TCP是打电话，接通才能说话。UDP是发电报，直管发，不管收

4. IP地址

   - 概念

   IP Address，为网络，和主机分配逻辑地址，以此来屏蔽物理地址的差异。

   ip就是互联网上各个终端的编号

   - ip地址的表示 ipv4

     32位的二进制数，分割成4个8位的二进制数

     点分十进制a.b.c.d   192.168.1.1

   - IP地址的分类

     每个ip分为两个标识，网络ID，主机ID。

     根据网络容量的大小

     | 列表       | 最大网络数 | ip范围                  | 最大主机数        | 私有地址范围                |
     | ---------- | ---------- | ----------------------- | ----------------- | --------------------------- |
     | A 大型网络 | 126        | 0.0.0.0-127.255.255.255 | 255 * 255 * 255-2 | 10.0.0.0-10.255.255.255     |
     | B 中型网络 |            |                         |                   |                             |
     | C 小型网络 |            |                         |                   | 192.168.0.0-192.168.255.255 |

     私有地址：局域网地址，内网地址

     公有地址：独一无二，互联网上的地址，申请的，花钱的组织

5. 端口

   port，操作系统，16位二进制数 2^16-1  65535个端口 0-65535

   分类：

   1. 周知端口

      操作系统给系统服务固定分配的端口，范围：0-1023

   2. 注册端口

      1024-49151，分配给用户进程的端口

   3. 动态端口

      49152-65535，一般不固定分配，有操作系统，动态分配

   ip用来表示终端，端口就用来区别程序，注意一个端口只能同时被一个程序监听

## 二、套接字（socket)

1. 概念

   socket就是一个接口，是对TCP，UDP的封装，为了简化技术难度。

2. python中使用socket

   创建套接字

   ```python
   # 创建套接字
   from socket import *   # 导入socket模块
   tcp_sock = socket(family=AF_INET, type=SOCK_STREAM)
   udp_sock = socket(family=AF_INET, type=SOCK_DGRAM)
   
   # family是地址簇，默认AF_INET type 指定是tcp还是udp
   ```

   创建一个tcp服务器

```
# 创建一个tcp server
from socket import socket   # 导入模块
# 1.创建套接字
tcp_server = socket()   # 默认就是tcp
# 2.绑定监听端口和ip
tcp_server.bind(('',8888))
# 3.开始监听
tcp_server.listen(5)
# 4.等待连接
print('开始等待')
client,addr = tcp_server.accept()       # 阻塞的，直到有连接进来
print('有连接进来 它的地址是：', addr)
while True:
    # 5.接受数据
    res = client.recv(1024)
    if res == b'':
        client.close()
        break
    print('接收到数据:', res.decode(encoding='utf-8'))
    # 6. 发送数据
    client.send(res)
```

创建一个tcp客户端

```
# 创建一个TCP客户端
from socket import socket
# 1.创建socket
client = socket()
# 2.连接服务端
client.connect(('127.0.0.1',8888))
while True:
    # 发送信息
    client.send(input('请输入信息：').encode())
    # 接收信息
    data = client.recv(1024)
    print(data.decode(encoding='utf-8'))
```

